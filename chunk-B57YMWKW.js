import{a as B}from"./chunk-WNI66HZL.js";import{a as A}from"./chunk-2O4QYMPI.js";import{h as U}from"./chunk-BPO3UDND.js";import"./chunk-IGDONR4E.js";import{$ as v,Bb as T,Jb as q,K as _,Lb as D,Mb as N,N as r,O as g,P as k,Pa as b,T as d,Z as p,_ as w,_a as S,ba as C,ca as y,eb as j,ga as f,ob as F,pb as M,qa as I,sa as x,u}from"./chunk-XKQUAFE5.js";var L={formId:"schoolknowledge",title:"Schoolknowledge",components:[{name:"Text",key:"title",focused:!0,fields:[{name:"Placeholder",value:"fill schoolknowledge title"},{name:"Label",value:"Title"}]}]};function K(i,e){if(i&1&&(C(0),I(1),y()),i&2){let a=f().$implicit,t=f();_(),x(" ",t.sks.doc(a.knowledge).title," ")}}function O(i,e){if(i&1&&d(0,K,2,1,"ng-container",2),i&2){let a=e.$implicit;p("ngIf",a.knowledge)}}var c=(()=>{let e=class e{get rows(){return this.knowledge?this.sks.schoolknowledgesByKnowledge[this.knowledge]:this.sks.schoolknowledgesBySchool[this.school]}constructor(t,s,o,l,m,E,R){this.sks=t,this._translate=s,this.route=o,this._alert=l,this._form=m,this._core=E,this._us=R,this.columns=["title","require"],this.form=this._form.getForm("schoolknowledge",L),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(n,h)=>{this._preCreate(n),this.sks.create(n),h()}})},update:n=>{this._form.modal(this.form,[],n).then(h=>{this._core.copy(h,n),this.sks.update(n)})},delete:n=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this schoolknowledge?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this.sks.delete(n)}}]})},buttons:[{icon:"cloud_download",click:n=>{this._form.modalUnique("schoolknowledge","url",n)}},{icon:"auto_stories",hrefFunc:n=>this._roleUrl()+"levels/"+this.school+"/"+n._id}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]}}ngOnInit(){this.route.params.subscribe(t=>{this.school=t.school||"",this.knowledge=t.knowledge||""})}_bulkManagement(t=!0){return()=>{this._form.modalDocs(t?[]:this.rows).then(s=>{if(t)for(let o of s)this._preCreate(o),this.sks.create(o);else{for(let o of this.rows)s.find(l=>l._id===o._id)||this.sks.delete(o);for(let o of s){let l=this.rows.find(m=>m._id===o._id);l?(this._core.copy(o,l),this.sks.update(l)):(this._preCreate(o),this.sks.create(o))}}})}}_preCreate(t){t.__created,this.school&&(t.school=this.school),this.knowledge&&(t.knowledge=this.knowledge)}_roleUrl(){return this._us.role("admin")?"/admin/":this._us.role("schoolowner")?"/owner/":this._us.role("schoolteacher")?"/teacher/":"/"}};e.\u0275fac=function(s){return new(s||e)(r(B),r(T),r(S),r(F),r(q),r(M),r(A))},e.\u0275cmp=g({type:e,selectors:[["ng-component"]],standalone:!1,decls:2,vars:3,consts:[["title","Levels",3,"columns","config","rows"],["cell","require"],[4,"ngIf"]],template:function(s,o){s&1&&(w(0,"wtable",0),d(1,O,1,1,"ng-template",1),v()),s&2&&p("columns",o.columns)("config",o.config)("rows",o.rows)},dependencies:[b,N,D],encapsulation:2});let i=e;return i})();var P=[{path:"",component:c},{path:":school",component:c},{path:":school/:knowledge",component:c}],ne=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=k({type:e}),e.\u0275inj=u({imports:[j.forChild(P),U]});let i=e;return i})();export{ne as LevelsModule};

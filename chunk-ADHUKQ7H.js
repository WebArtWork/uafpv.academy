import{a as D}from"./chunk-2O4QYMPI.js";import{f as q,h as B}from"./chunk-BPO3UDND.js";import"./chunk-IGDONR4E.js";import{$ as a,Ab as u,Bb as L,Hb as N,Jb as U,K as c,N as n,O as I,P as b,Pa as E,T as x,Z as p,_ as o,a as k,ab as j,b as y,ea as g,eb as P,fa as l,ga as v,ob as M,pb as T,qa as S,u as C,ub as V,y as f,yb as F,z as _}from"./chunk-XKQUAFE5.js";function z(r,e){if(r&1){let h=g();o(0,"span",9),l("click",function(){f(h);let i=v();return _(i.us.setMode("dark"))}),S(1," dark_mode "),a()}}function G(r,e){if(r&1){let h=g();o(0,"span",10),l("click",function(){f(h);let i=v();return _(i.us.setMode())}),S(1," light_mode "),a()}}var R=(()=>{let e=class e{constructor(t,i,s,d,A,H,J,O){this.us=t,this.ui=i,this._alert=s,this._http=d,this._router=A,this._form=H,this._translate=J,this._core=O,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Submit",value:!0},{name:"Click",value:()=>{this.submit()}}]}]}),this.user=y(k({},u.user),{resetPin:null}),this._set=m=>{if(m){let w=m.token||"";w&&this._http.set("token",w),this._core.emit("wipe"),localStorage.setItem("waw_user",JSON.stringify(m)),this.us.setUser(m),this.us.get({query:u.appId?"appId="+u.appId:""}),this._router.navigateByUrl("/profile")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?this._http.post("/api/user/status",this.user,t=>{t.email&&t.pass?this.login():t.email?this.reset():this.sign()}):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",this.user,this._set.bind(this))}sign(){this._http.post("/api/user/sign",this.user,this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,t=>{t?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}};e.\u0275fac=function(i){return new(i||e)(n(D),n(F),n(M),n(V),n(j),n(U),n(L),n(T))},e.\u0275cmp=I({type:e,selectors:[["ng-component"]],standalone:!1,decls:9,vars:4,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img"],[3,"click"],[1,"auth__form"],[1,"auth"],["class","material-icons",3,"click",4,"ngIf"],["class","material-icons auth__icon",3,"click",4,"ngIf"],[3,"wSubmit","submition","config"],[1,"material-icons",3,"click"],[1,"material-icons","auth__icon",3,"click"]],template:function(i,s){i&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"icon-spider",3),l("click",function(){return s.us.setMode(s.us.mode?"":"dark")}),a()(),o(4,"div",4)(5,"div",5),x(6,z,2,0,"span",6)(7,G,2,0,"span",7),o(8,"wform",8),l("wSubmit",function(){return s.submit()}),a()()()()()),i&2&&(c(6),p("ngIf",!s.us.mode),c(),p("ngIf",s.us.mode),c(),p("submition",s.user)("config",s.form))},dependencies:[E,N,q],encapsulation:2});let r=e;return r})();var K=[{path:"",component:R}],me=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=b({type:e}),e.\u0275inj=C({imports:[P.forChild(K),B]});let r=e;return r})();export{me as SignModule};
